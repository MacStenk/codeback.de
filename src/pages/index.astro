---
import "../styles/global.css";
import SEO from "../components/SEO.astro";
import Header from "../components/layout/Header.astro";
import Footer from "../components/Footer.astro";
import Hero from "../components/sections/Hero.astro";
import TargetAudience from "../components/sections/TargetAudience.astro";
import LiveDemo from "../components/sections/LiveDemo.astro";
import ProblemSection from "../components/sections/ProblemSection.astro";
import ConceptSection from "../components/sections/ConceptSection.astro";
import PricingSection from "../components/sections/PricingSection.astro";
import FutureSection from "../components/sections/FutureSection.astro";
import TechStack from "../components/sections/TechStack.astro";
import CTASection from "../components/sections/CTASection.astro";
import FAQSection from "../components/sections/FAQSection.astro";
import { getEntry } from 'astro:content';

// Load homepage data from TinaCMS
const homepageData = await getEntry('homepage', 'index');
const blocks = homepageData?.data?.blocks || [];

const pageTitle = "Codeback. Websites die Antworten werden";
const pageDescription =
  "LLM SEO und Answer Engine Optimization für die Zukunft der digitalen Sichtbarkeit";
---

<!doctype html>
<html lang="de">
  <head>
    <SEO
      title={pageTitle}
      description={pageDescription}
      canonical="https://codeback.de"
      type="website"
    />

    <!-- Schema.org für LLMs -->
    <script
      type="application/ld+json"
      set:html={JSON.stringify({
        "@context": "https://schema.org",
        "@type": "WebSite",
        name: "CodeBack",
        url: "https://codeback.de",
        description: pageDescription,
        author: {
          "@type": "Person",
          name: "Steven Noack",
          url: "https://stevennoack.de",
        },
        about: {
          "@type": "Service",
          name: "LLM-native Web Development",
          description:
            "Entwicklung von Websites die für Large Language Models optimiert sind",
        },
      })}
    />
  </head>

  <body class="bg-white text-zinc-900">
    <Header />

    <main id="main-content" class="max-w-4xl mx-auto px-6 py-20">
      <article>
        <!-- Dynamic Block Rendering from TinaCMS -->
        {blocks.map((block: any) => {
          switch (block._template) {
            case 'hero':
              return <Hero data={block} />;
            case 'targetAudience':
              return <TargetAudience data={block} />;
            case 'liveDemo':
              return <LiveDemo data={block} />;
            case 'problem':
              return <ProblemSection data={block} />;
            case 'concept':
              return <ConceptSection data={block} />;
            case 'pricing':
              return <PricingSection data={block} />;
            case 'future':
              return <FutureSection data={block} />;
            case 'techStack':
              return <TechStack data={block} />;
            case 'faq':
              return <FAQSection data={block} />;
            case 'cta':
              return <CTASection data={block} />;
            default:
              return null;
          }
        })}
      </article>
    </main>

    <Footer />
  </body>
</html>
